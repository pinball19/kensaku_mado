<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Firestore Search by Document ID</title>
</head>
<body>
  <h1>Search by Document ID</h1>
  <div>
    <input id="docIdInput" type="text" placeholder="ドキュメントIDを入力" />
    <button id="searchBtn">取得</button>
  </div>
  <div id="result"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-app.js";
    import {
      getFirestore,
      doc,
      getDoc
    } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-firestore.js";

    // あなたのfirebaseConfigを貼り付け
const firebaseConfig = {
  apiKey: "AIzaSyCnRbmcPezD4Osisss6XebmU15ukBqttQw",
  authDomain: "slack-bot-firebase-7991a.firebaseapp.com",
  projectId: "slack-bot-firebase-7991a",
  storageBucket: "slack-bot-firebase-7991a.firebasestorage.app",
  messagingSenderId: "215585745043",
  appId: "1:215585745043:web:0c70ac99c5066b56cd4566"
};

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const docIdInput = document.getElementById("docIdInput");
    const searchBtn = document.getElementById("searchBtn");
    const result = document.getElementById("result");

    searchBtn.addEventListener("click", async () => {
      const docId = docIdInput.value.trim();
      if (!docId) return;

      // productsコレクション内の特定ドキュメントIDを取得
      const docRef = doc(db, "products", docId);
      try {
        const docSnap = await getDoc(docRef);
        if (docSnap.exists()) {
          const data = docSnap.data();
          // 取得成功 -> データを画面に表示
          result.innerHTML = `
            <p>ドキュメントID: ${docId}</p>
            <pre>${JSON.stringify(data, null, 2)}</pre>
          `;
        } else {
          // 該当ドキュメントが存在しない
          result.innerHTML = "<p>該当ドキュメントが見つかりません。</p>";
        }
      } catch (err) {
        console.error("取得エラー:", err);
        result.innerHTML = "<p>エラーが発生しました。</p>";
      }
    });
  </script>
</body>
</html>
